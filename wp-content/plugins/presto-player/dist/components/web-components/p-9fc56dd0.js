import{j as n}from"./p-a1d6ef6b.js";import{P as t}from"./p-2e64bf99.js";export default function(o){var r=o.config,e=o.selector,a=o.src,i=o.preload;return new Promise((function(o){if(window.Hls){if(window.Hls.isSupported()){var u,w=!["metadata","none"].includes(i);null!==(u=wp)&&void 0!==u&&u.blocks&&(w=!0);var f=new window.Hls({autoStartLoad:w});return f.loadSource(a),f.on(window.Hls.Events.LEVEL_SWITCHED,(function(n,t){e.closest(".presto-player__wrapper").querySelector(".plyr__menu__container [data-plyr='quality'][value='0'] span").innerHTML=f.autoLevelEnabled?"AUTO (".concat(f.levels[t.level].height,"p)"):"AUTO"})),void f.on(window.Hls.Events.MANIFEST_PARSED,(function(){var a=f.levels.map((function(n){return n.height}));a.unshift(0);var i=a.findIndex((function(n){var t;return n===parseInt(null===(t=prestoPlayer)||void 0===t?void 0:t.hls_start_level)}));f.startLevel=i?i-1:2,r.quality={default:0,options:a,forced:!0,onChange:function(n){0===n?prestoHLS.currentLevel=-1:prestoHLS.levels.forEach((function(t,o){t.height===n&&(console.log("Found quality match with "+n),prestoHLS.currentLevel=o)}))}},f.attachMedia(e),window.prestoHLS=f;var u=new t(e,n({},r));return u.hls=f,u.on("waiting",(function n(){f.startLoad(-1),u.off("waiting",n)})),u.on("languagechange",(function(){setTimeout((function(){return f.subtitleTrack=u.currentTrack}),50)})),o(u)}))}return o(new t(e,n({},r)))}}))}