{"version":3,"sources":["webpack:///./packages/components/dist/custom-elements/learndash.js"],"names":["learndash","player","_learndash_video_data","_prestoPlayer","_prestoPlayer$learnda","_learndash_video_data2","_prestoPlayer2","_prestoPlayer2$learnd","_prestoPlayer3","_prestoPlayer3$learnd","_prestoPlayer4","_prestoPlayer4$learnd","_learndash_video_data3","learndash_video_data","videos_found_provider","resumeProgress","window","videos_auto_complete","prestoPlayer","lesson_video_auto_complete","videos_hide_complete_button","videos_shown","lesson_video_hide_complete_button","videos_auto_complete_delay","lesson_video_auto_complete_delay","videos_auto_complete_delay_message","video_track_path","jQuery","document","trigger","video_debug","console","log","querySelectorAll","length","LearnDash_disable_assets","LearnDash_watchPlayers","forEach","element","index","element_key","element_id","getAttribute","setAttribute","ld_video_players","closest","LearnDash_Video_Progress_initSettings","LearnDash_Video_Progress_getSetting","LearnDash_watchPlayersEnd","wp","hooks","addAction","LearnDash_Video_Progress_setSetting","duration","currentTime"],"mappings":"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","file":"analytics/5-668d8057.js","sourcesContent":["import { r as resumeProgress } from './index.js';\n\nconst learndash = (function (player) {\n  var _learndash_video_data, _prestoPlayer, _prestoPlayer$learnda, _learndash_video_data2, _prestoPlayer2, _prestoPlayer2$learnd, _prestoPlayer3, _prestoPlayer3$learnd, _prestoPlayer4, _prestoPlayer4$learnd, _learndash_video_data3;\n\n  if (typeof learndash_video_data === 'undefined' || ((_learndash_video_data = learndash_video_data) === null || _learndash_video_data === void 0 ? void 0 : _learndash_video_data.videos_found_provider) !== 'presto') {\n    return;\n  }\n\n  resumeProgress(player); // maybe resume progress\n  // Learndash has this logic in a shitty method on their php class\n  // we have to fake it here since we don't have access to it\n\n  window.learndash_video_data.videos_auto_complete = ((_prestoPlayer = prestoPlayer) === null || _prestoPlayer === void 0 ? void 0 : (_prestoPlayer$learnda = _prestoPlayer.learndash) === null || _prestoPlayer$learnda === void 0 ? void 0 : _prestoPlayer$learnda.lesson_video_auto_complete) === 'on';\n  window.learndash_video_data.videos_hide_complete_button = 'AFTER' === ((_learndash_video_data2 = learndash_video_data) === null || _learndash_video_data2 === void 0 ? void 0 : _learndash_video_data2.videos_shown) && ((_prestoPlayer2 = prestoPlayer) === null || _prestoPlayer2 === void 0 ? void 0 : (_prestoPlayer2$learnd = _prestoPlayer2.learndash) === null || _prestoPlayer2$learnd === void 0 ? void 0 : _prestoPlayer2$learnd.lesson_video_hide_complete_button) === 'on';\n  window.learndash_video_data.videos_auto_complete_delay = (_prestoPlayer3 = prestoPlayer) === null || _prestoPlayer3 === void 0 ? void 0 : (_prestoPlayer3$learnd = _prestoPlayer3.learndash) === null || _prestoPlayer3$learnd === void 0 ? void 0 : _prestoPlayer3$learnd.lesson_video_auto_complete_delay;\n  window.learndash_video_data.videos_auto_complete_delay_message = (_prestoPlayer4 = prestoPlayer) === null || _prestoPlayer4 === void 0 ? void 0 : (_prestoPlayer4$learnd = _prestoPlayer4.learndash) === null || _prestoPlayer4$learnd === void 0 ? void 0 : _prestoPlayer4$learnd.videos_auto_complete_delay_message; // Temporarily set the video track path to '/' to set the cookie globally\n\n  window.learndash_video_data.video_track_path = '/'; // Learndash has this logic in a shitty method on their php class\n  // we have to fake it here since we don't have access to it\n\n  if ('BEFORE' === ((_learndash_video_data3 = learndash_video_data) === null || _learndash_video_data3 === void 0 ? void 0 : _learndash_video_data3.videos_shown)) {\n    learndash_video_data.videos_auto_complete = false;\n    jQuery(document).trigger('learndash_video_disable_assets', [true]); // Set learndash video players\n\n    jQuery(function () {\n      if (learndash_video_data.video_debug === '1') {\n        console.log('PRESTO: init');\n      }\n\n      if (document.querySelectorAll('presto-player[data-video-progression=\"true\"][data-video-provider=\"' + learndash_video_data.videos_found_provider + '\"]').length) {\n        if (learndash_video_data.video_debug === '1') {\n          console.log('PRESTO: calling LearnDash_disable_assets(true)');\n        } // Disable learndash assets and watch players.\n\n\n        LearnDash_disable_assets(true);\n        LearnDash_watchPlayers(); // Go through all the <presto-player> instances\n\n        document.querySelectorAll('presto-player[data-video-progression=\"true\"][data-video-provider=\"' + learndash_video_data.videos_found_provider + '\"]').forEach(function (element, index) {\n          var element_key = 'presto-player__wrapper-player-' + index;\n          var element_id = element.getAttribute('id');\n\n          if (typeof element_id === 'undefined' || element_id == '') {\n            element_id = element_key;\n            element.setAttribute('id', element_id);\n          }\n\n          ld_video_players[element_key] = {};\n          ld_video_players[element_key]['player_key'] = element_key;\n          ld_video_players[element_key]['player_type'] = learndash_video_data.videos_found_provider;\n          ld_video_players[element_key]['player_id'] = element_id;\n          ld_video_players[element_key]['player_wrapper'] = element.closest('presto-player');\n\n          if (typeof ld_video_players[element_key]['player_wrapper'] !== 'undefined') {\n            ld_video_players[element_key]['player_cookie_key'] = ld_video_players[element_key]['player_wrapper'].getAttribute('data-video-cookie-key');\n          } else {\n            ld_video_players[element_key]['player_cookie_key'] = '';\n          }\n\n          ld_video_players[element_key]['player_cookie_values'] = LearnDash_Video_Progress_initSettings(ld_video_players[element_key]); // Check if video has been completed already.\n          // If yes, enable the assets back and end watch players function.\n          // If no, then apply all the filters and performs the actions again.\n\n          if (LearnDash_Video_Progress_getSetting(ld_video_players[element_key], 'video_state') === 'complete') {\n            LearnDash_disable_assets(false);\n            LearnDash_watchPlayersEnd();\n          } else {\n            // Player Seeked.\n            wp.hooks.addAction('presto.playerTimeUpdate', 'presto-player', function (player) {\n              if (learndash_video_data.video_debug === '1') {\n                console.log('PRESTO: Video is playing');\n              }\n\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_duration', player.duration);\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_time', player.currentTime);\n\n              if (player.duration && player.duration === player.currentTime) {\n                LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_state', 'complete');\n\n                if (learndash_video_data.video_debug === '1') {\n                  console.log('PRESTO: calling LearnDash_disable_assets(false)');\n                }\n\n                LearnDash_disable_assets(false); // Stop watching players.\n\n                LearnDash_watchPlayersEnd();\n              }\n            }); // Player Playing.\n\n            wp.hooks.addAction('presto.playerPlaying', 'presto-player', function (player) {\n              if (learndash_video_data.video_debug === '1') {\n                console.log('PRESTO: Video is playing');\n              }\n\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_duration', player.duration);\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_time', player.currentTime);\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_state', 'play');\n            }); // Player Paused.\n\n            wp.hooks.addAction('presto.playerPause', 'presto-player', function (player) {\n              if (learndash_video_data.video_debug === '1') {\n                console.log('PRESTO: Video is paused');\n              }\n\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_time', player.currentTime);\n              console.log(player.duration);\n              console.log(player.currentTime);\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_state', 'pause');\n            }); // Player Ended.\n\n            wp.hooks.addAction('presto.playerEnded', 'presto-player', function (player) {\n              if (learndash_video_data.video_debug === '1') {\n                console.log('PRESTO: video ended');\n              }\n\n              if (learndash_video_data.video_debug === '1') {\n                console.log(\"PRESTO: setting 'video_state' to 'complete'\");\n              }\n\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_time', player.currentTime);\n              LearnDash_Video_Progress_setSetting(ld_video_players[element_key], 'video_state', 'complete');\n\n              if (learndash_video_data.video_debug === '1') {\n                console.log('PRESTO: calling LearnDash_disable_assets(false)');\n              }\n\n              LearnDash_disable_assets(false); // Stop watching players.\n\n              LearnDash_watchPlayersEnd();\n            });\n          }\n        });\n      }\n    });\n    return;\n  } else {\n    window.LearnDash_disable_assets(true);\n    wp.hooks.addAction('presto.playerEnded', 'presto-player', function () {\n      window.LearnDash_disable_assets(false);\n    });\n  }\n});\n\nexport default learndash;\n"],"sourceRoot":""}